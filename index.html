<!doctype html>
<html class= "font-Roboto" lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Theremin</title>
    </head>
    
    <body class="min-h-screen justify-center bg-gradient-to-b from-stone-900 to-bg-zinc-700">
    
      <p class="text-3xl pt-5 text-zinc-200">Theremin</p>
      <div id="content" class="flex flex-row gap-5 content-center">
        <!-- VIDEO -->
        <div class="flex-basis-5/7" id="video-container">
          <video class="flex" autoplay playsinline></video>
          <canvas class="absolute"></canvas>
        </div>

        <!-- NAV MENU -->
        <div class="py-2 flex-grow rounded-2xl px-4 bg-white" >
          <p class="text-2xl text-stone-700">Record</p>
          <div class="inline-flex items-center">
            <!-- ACTIVATE            -->
            <button id="toggleActivation" type="button"
              class="text-gray-700 px-4 py-2 text-sm bg-white shadow-lg ring-1 ring-black ring-opacity-5 transition inline-flex items-center mr-2">
    
              <svg id="svgActivate" class="fill-current w-6 h-4 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"
                stroke-width="1.0" stroke="currentColor">
                <!-- Initial SVG content -->
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75" />
              </svg>
              <span id="textActivate">Sound On</span>
            </button>
    
            <script>
              document.addEventListener('DOMContentLoaded', function () {
                const button = document.getElementById('toggleActivation');
                const svgIcon = document.getElementById('svgActivate');
                const buttonText = document.getElementById('textActivate');

                let isStart = true;

                button.addEventListener('click', function () {
                  // Toggle the state
                  isStart = !isStart;
                  // Update SVG and text based on the state
                  if (isStart) {
                    svgIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" d="M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.7" />';
                    buttonText.innerText = 'Sound On ';
                  } else {
                    svgIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" d="M19.114 5.636a9 9 0 0 1 0 12.728M16.463 8.288a5.25 5.25 0 0 1 0 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z" />';
                    buttonText.innerText = 'Sound Off';
                  }
                });
              });
            </script>
 
    
            <!-- RECORD -->
            <button id="toggleRecord" type="button"
              class="text-gray-700 px-4 py-2 text-sm bg-white shadow-lg ring-1 ring-black ring-opacity-5 transition inline-flex items-center mr-2">
              <svg id="svgRecord" class="fill-current w-4 h-4 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"
                stroke-width="1.0" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z" />
              </svg>
              <span id="textRecord">Record</span>
            </button>

            <!-- DOWNLOAD  -->
            <button disabled id="videoDownload" type="button" download="recorded_video.webm"
              class="text-gray-700 px-4 py-2 text-sm bg-white shadow-lg ring-1 ring-black ring-opacity-5 opacity-50 transition inline-flex items-center">
              <svg class="fill-current w-4 h-4 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                <path d="M13 8V2H7v6H2l8 8 8-8h-5zM0 18h20v2H0v-2z" />
              </svg>
              <span>Download</span>
            </button>


            <!-- STOPS STARTS AND DOWNLOADS -->
            <script>
              document.addEventListener('DOMContentLoaded', function () {
                const button = document.getElementById('toggleRecord');
                const svgIcon = document.getElementById('svgRecord');
                const buttonText = document.getElementById('textRecord');

                const downloadButton = document.getElementById('videoDownload');

                const video = document.getElementById('video-container'); // Add a video element to your HTML
                let mediaRecorder;
                let chunks = [];


                async function startRecording() {
                  const stream = await navigator.mediaDevices.getUserMedia({ video: true });

                  mediaRecorder = new MediaRecorder(stream);

                  mediaRecorder.ondataavailable = function (event) {
                    if (event.data.size > 0) {
                      chunks.push(event.data);
                    }
                  };

                  mediaRecorder.onstop = function () {
                    const blob = new Blob(chunks, { type: 'video/webm' });
                    const url = URL.createObjectURL(blob);
                    video.src = url;
                  };

                  mediaRecorder.start();
                  downloadButton.disabled = true;
                  downloadButton.classList.add('opacity-50');
                }

                function stopRecording() {
                  if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                    downloadButton.classList.remove('opacity-50');
                    downloadButton.disabled = false;
                    mediaRecorder.stop();
                  }

                }

                let isStart = true;

                button.addEventListener('click', function () {
                // Toggle the state
                  isStart = !isStart;
                  // Update SVG and text based on the state
                  if (isStart) {
                    chunks = [];
                    svgIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" d="M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z" />';
                    buttonText.innerText = 'Record';
                    stopRecording();
                    console.log('no!!');
                  } else {
                    svgIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" d="M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z" />';
                    buttonText.innerText = 'Stop     ';
                    startRecording();
                    console.log('recording!!');
                  }
                });
                downloadButton.addEventListener('click', function () {
                  if (chunks.length > 0) {
                    const blob = new Blob(chunks, { type: 'video/webm' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'recorded_video.webm';
                    a.click();
                  }
                });
              });
            </script>
    
    
          </div>
    
          <div class="py-3">
            <p class="text-2xl text-stone-700">Lead</p>
            <div class="relative inline-block text-left">
              <div>
                <button type="button"
                  class="inline-flex w-full justify-center gap-x-1.5 rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50"
                  id="menu-button" aria-expanded="false" aria-haspopup="true">
                  Pick Lead
                  <svg class="-mr-1 h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                    <path fill-rule="evenodd"
                      d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
                      clip-rule="evenodd" />
                  </svg>
                </button>
              </div>
    
              <!-- Dropdown menu, hidden by default -->
              <div
                id = "lead-drop"
                class="absolute left-0 z-10 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none hidden"
                role="menu" aria-orientation="vertical" aria-labelledby="menu-button" tabindex="-1">
                <div class="py-1" role="none">
                  <!-- Active: "bg-gray-100 text-gray-900", Not Active: "text-gray-700" -->
                  <a href="#" class="text-gray-700 block px-4 py-2 text-sm" role="menuitem" tabindex="-1"
                    id="l_menu-item-0">Sine</a>
                  <a href="#" class="text-gray-700 block px-4 py-2 text-sm" role="menuitem" tabindex="-1"
                    id="l_menu-item-1">Square</a>
                  <a href="#" class="text-gray-700 block px-4 py-2 text-sm" role="menuitem" tabindex="-1"
                    id="l_menu-item-2">Triangle</a>
                  <a href="#" class="text-gray-700 block px-4 py-2 text-sm" role="menuitem" tabindex="-1"
                    id="l_menu-item-3">Saw</a>
                </div>
              </div>
            </div>
          </div>
    
          <script>
            document.addEventListener('DOMContentLoaded', function () {
              const button = document.getElementById('menu-button');
              const dropdown = document.getElementById('lead-drop');

              button.addEventListener('click', function () {
                // Toggle the "hidden" class on the dropdown menu
                dropdown.classList.toggle('hidden');

                // Toggle the "aria-expanded" attribute on the button
                const isExpanded = button.getAttribute('aria-expanded') === 'true';
                button.setAttribute('aria-expanded', (!isExpanded).toString());
              });

              // Close the dropdown when clicking outside of it
              document.addEventListener('click', function (event) {
                if (!button.contains(event.target) && !dropdown.contains(event.target)) {
                  dropdown.classList.add('hidden');
                  button.setAttribute('aria-expanded', 'false');
                }
              });
            });
          </script>
    
         <!--pop hiphop trap  -->
         <div class="py-3">
          <p class="text-2xl text-stone-700">Beat Style</p>
          <div class="relative inline-block text-left">
            <div>
              <button type="button" id="beat-menu"
                class="inline-flex w-full justify-center gap-x-1.5 rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50"
                aria-expanded="false" aria-haspopup="true">
                Pick Beat
                <svg class="-mr-1 h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                  <path fill-rule="evenodd"
                    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
                    clip-rule="evenodd" />
                </svg>
              </button>
            </div>
  
            <!-- Dropdown menu, hidden by default -->
            <div
              id = "beat-drop"
              class="absolute left-0 z-10 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none hidden"
              role="menu" aria-orientation="vertical" aria-labelledby="beat-menu" tabindex="-2">
              <div class="py-1" role="none">
                <!-- Active: "bg-gray-100 text-gray-900", Not Active: "text-gray-700" -->
                <a href="#" class="text-gray-700 block px-4 py-2 text-sm" role="menuitem" tabindex="-2"
                  id="b_menu-item-0">Pop</a>
                <a href="#" class="text-gray-700 block px-4 py-2 text-sm" role="menuitem" tabindex="-2"
                  id="b_menu-item-1">Hip-Hop</a>
                <a href="#" class="text-gray-700 block px-4 py-2 text-sm" role="menuitem" tabindex="-2"
                  id="b_menu-item-2">Trap</a>
              </div>
            </div>
          </div>

          <div class="py-3">
            <p class="text-2xl text-stone-700 ">Audio Options</p>
            <label class="switch" for="btn">
              <input id="btn" type="checkbox" style="opacity: 0; position: absolute;">
              <span class="slider"></span>
            </label>
            <span class="py-3 text-stone-700 text-xl" style="vertical-align: top; padding-top: 5px;">Slide</span>
          </div>
          <div class="py-3">
            <span class="text-stone-700 text-xl" style="vertical-align: top; padding-top: 5px;">Major</span>
            <label class="switch" for="majorBtn">
                <input id="majorBtn" type="checkbox" style="opacity: 0; position: absolute;">
                <span class="slider"></span>
            </label>
            <span class="text-stone-700 text-xl" style="vertical-align: top; padding-top: 5px;">Minor</span>
        </div>
  
        <script>
          document.addEventListener('DOMContentLoaded', function () {
            const button = document.getElementById('beat-menu');
            const dropdown = document.getElementById('beat-drop');

            button.addEventListener('click', function () {
              // Toggle the "hidden" class on the dropdown menu
              dropdown.classList.toggle('hidden');

              // Toggle the "aria-expanded" attribute on the button
              const isExpanded = button.getAttribute('aria-expanded') === 'true';
              button.setAttribute('aria-expanded', (!isExpanded).toString());
            });

            // Close the dropdown when clicking outside of it
            document.addEventListener('click', function (event) {
              if (!button.contains(event.target) && !dropdown.contains(event.target)) {
                dropdown.classList.add('hidden');
                button.setAttribute('aria-expanded', 'false');
              }
            });
          });
        </script> 
        </div>
        
    
      </div>
      <script type="module" src="/main.js"></script>
    </body>
    
    </html>
